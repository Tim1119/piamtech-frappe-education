var w=(C,p,c)=>new Promise((g,i)=>{var l=d=>{try{b(c.next(d))}catch(h){i(h)}},v=d=>{try{b(c.throw(d))}catch(h){i(h)}},b=d=>d.done?g(d.value):Promise.resolve(d.value).then(l,v);b((c=c.apply(C,p)).next())});import{r as f,k as V,a9 as S,s as u,v as _,x as e,y as o,z as n,D as s,L as m,M as k,X as x,P as B,F as y,K as L,I as Y,J as j,a8 as F,B as M}from"./frappe-ui.97769d2e.js";const z={class:"min-h-screen bg-gray-50 px-6 py-8"},D={class:"mb-8"},I={class:"bg-white rounded-lg p-6 shadow-sm border"},$={class:"flex justify-between items-center"},O=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"My Individual Awards"),e("p",{class:"text-gray-600"},"View personal certificates and recognition")],-1),P={class:"bg-white rounded-lg shadow-sm border p-6 mb-6"},R=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Filter Awards",-1),U={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},J=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Year",-1),K=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Category",-1),T={class:"flex items-end"},X={key:0,class:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4"},q={class:"flex items-start"},G=e("h3",{class:"text-sm font-medium text-red-800"},"Error Loading Awards",-1),H={class:"text-sm text-red-700 mt-1"},Q={key:1,class:"text-center py-12"},W=e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"},null,-1),Z=e("p",{class:"text-gray-600"},"Loading your awards...",-1),ee=[W,Z],ae={key:2,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},te={class:"text-lg font-semibold text-gray-900 mb-1"},se={class:"text-sm text-gray-600 mb-2"},le={class:"text-sm text-gray-700 mb-4"},oe={class:"flex justify-between items-center border-t pt-4"},re={class:"text-xs text-gray-500"},ie={key:3,class:"text-center py-12"},ne={class:"bg-white rounded-lg p-8 shadow-sm border"},de=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No Awards Found",-1),ce=e("p",{class:"text-gray-600"},"You don't have any individual awards yet.",-1),ve={__name:"IndividualAwards",setup(C){const p=f(!1),c=f(!1),g=f([]),i=f(""),l=f(""),v=f(""),b=V(()=>{const r=[...new Set(g.value.map(a=>a.year))].sort();return[{label:"All Years",value:"",onClick:()=>i.value=""}].concat(r.map(a=>({label:a,value:a,onClick:()=>i.value=a})))}),d=[{label:"All Categories",value:"",onClick:()=>l.value=""},{label:"Academic",value:"Academic",onClick:()=>l.value="Academic"},{label:"Sports",value:"Sports",onClick:()=>l.value="Sports"},{label:"Leadership",value:"Leadership",onClick:()=>l.value="Leadership"},{label:"Behavioural",value:"Behavioural",onClick:()=>l.value="Behavioural"}],h=V(()=>g.value.filter(r=>(!i.value||r.year===i.value)&&(!l.value||r.category===l.value))),A=()=>w(this,null,function*(){p.value=!0,c.value=!0,v.value="";try{const r=yield F("piamtech_frappe_education.school_portal_api.get_individual_awards");g.value=(r||[]).map(a=>({name:a.name,title:a.certificate_title,date:a.certificate_date,description:a.description,category:a.certificate_type,year:a.academic_year,file:a.certificate_file}))}catch(r){console.error("Error loading awards:",r),v.value=r.message||"Failed to load awards. Please try again."}finally{p.value=!1,c.value=!1}}),E=()=>{i.value="",l.value=""},N=r=>w(this,null,function*(){try{const a=yield F("piamtech_frappe_education.school_portal_api.download_certificate",{award_name:r.name});a.file_url&&window.open(a.file_url,"_blank")}catch(a){console.error("Error downloading certificate:",a),alert("Error downloading certificate: "+a.message)}});return S(()=>{A()}),(r,a)=>(u(),_("div",z,[e("div",D,[e("div",I,[e("div",$,[O,e("div",null,[o(s(x),{onClick:A,loading:c.value,size:"sm",variant:"outline"},{prefix:n(()=>[o(s(m),{name:"refresh-cw",class:"h-4 w-4"})]),default:n(()=>[k(" Refresh ")]),_:1},8,["loading"])])])])]),e("div",P,[R,e("div",U,[e("div",null,[J,o(s(B),{options:b.value,modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=t=>i.value=t)},{default:n(({open:t})=>[o(s(x),{label:i.value||"All Years",class:"w-full justify-between"},{suffix:n(()=>[o(s(m),{name:t?"chevron-up":"chevron-down",class:"h-4 text-gray-600"},null,8,["name"])]),_:2},1032,["label"])]),_:1},8,["options","modelValue"])]),e("div",null,[K,o(s(B),{options:d,modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=t=>l.value=t)},{default:n(({open:t})=>[o(s(x),{label:l.value||"All Categories",class:"w-full justify-between"},{suffix:n(()=>[o(s(m),{name:t?"chevron-up":"chevron-down",class:"h-4 text-gray-600"},null,8,["name"])]),_:2},1032,["label"])]),_:1},8,["modelValue"])]),e("div",T,[o(s(x),{onClick:E,class:"w-full",variant:"outline"},{prefix:n(()=>[o(s(m),{name:"x-circle",class:"h-4 w-4"})]),default:n(()=>[k(" Clear Filters ")]),_:1})])])]),v.value?(u(),_("div",X,[e("div",q,[o(s(m),{name:"alert-circle",class:"h-5 w-5 text-red-600 mt-0.5 mr-3"}),e("div",null,[G,e("p",H,y(v.value),1)])])])):L("",!0),p.value?(u(),_("div",Q,ee)):h.value.length>0?(u(),_("div",ae,[(u(!0),_(Y,null,j(h.value,t=>(u(),_("div",{key:t.name,class:"bg-white rounded-lg shadow-sm border p-6 hover:shadow-md transition-shadow"},[e("h3",te,y(t.title),1),e("p",se,y(t.date),1),e("p",le,y(t.description),1),e("div",oe,[e("span",re,y(t.category),1),t.file?(u(),M(s(x),{key:0,size:"sm",onClick:ue=>N(t)},{prefix:n(()=>[o(s(m),{name:"download",class:"h-4 w-4"})]),default:n(()=>[k(" Certificate ")]),_:2},1032,["onClick"])):L("",!0)])]))),128))])):(u(),_("div",ie,[e("div",ne,[o(s(m),{name:"award",class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),de,ce])]))]))}};export{ve as default};
